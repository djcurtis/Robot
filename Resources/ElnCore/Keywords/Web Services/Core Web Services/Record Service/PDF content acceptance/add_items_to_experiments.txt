*** Settings ***
Resource          ../../../../Libraries/Core Web Services/Entity Lock Service/rest_entity_lock_service.txt
Resource          ../../../../Libraries/Core Web Services/Entity Service/rest_entity_service_resource.txt
Library           OperatingSystem

*** keywords ***
Add Text Item To Experiment
    [Arguments]    ${experiment_id}    ${data_file_location}    ${item_type}=Uploaded text document
    [Documentation]    Adds a html text item to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${data_file_location} \ where the data file is picked up
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    ${text_doc_entity_id}=    Add TEXT_DOCUMENT To Experiment    ${experiment_id}    ${data_file_location}    text/html    HTML_TEXT    ${item_type}
    [Return]    ${text_doc_entity_id}

Add Text Component To Item
    [Arguments]    ${experiment_id}    ${text_item_id}    ${data_file_location}    ${item_type}=Uploaded text document
    [Documentation]    Adds a html text item to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${text_item_id} id of exp or record to put it in
    ...
    ...    ${data_file_location} \ where the data file is picked up
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    ${text_component_entity_id}=    Add TEXT_COMPONENT To Text Item    ${experiment_id}    ${text_item_id}    ${data_file_location}    application/x-idbs-document-content    TEXT_COMPONENT
    ...    ${item_type}
    [Return]    ${text_component_entity_id}

Add Form Item To Experiment
    [Arguments]    ${experiment_id}    ${data_file_location}    ${item_type}=Uploaded form document
    [Documentation]    Adds a form item to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${data_file_location} \ where the data file is picked up
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    ${form_entity_id}=    Add DOCUMENT To Experiment    ${experiment_id}    ${data_file_location}    application/x-idbs-form    FORM    ${item_type}
    [Return]    ${form_entity_id}

Add MFS Item To Experiment
    [Arguments]    ${experiment_id}    ${string_data}
    [Documentation]    Adds a form item to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${string_data} the data for the item
    ...
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${experiment_id}
    ${doc_entity_id}=    Add DOCUMENT With String Data    ${experiment_id}    ${string_data}    application/x-idbs-largefilelink    MANAGED FILE SET
    Commit Versioned Entity    ${experiment_id}
    Unlock entity    ${experiment_id}
    [Return]    ${doc_entity_id}

Add Entity Link Item To Experiment
    [Arguments]    ${experiment_id}    ${target_link_id}    ${entity_link_template_file}
    [Documentation]    Adds an entity link item to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${target_link_id} the entity to which the link must be made
    ...
    ...    ${entity_link_temaplte_file} the entity link template (which will need expansion with at least the entity id)
    ...
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${link_experiment_id}
    ${item_content template}=    Get File    ${entity_link_template_file}
    ${TARGET_ENTITY_ID}=    Set Variable    ${target_link_id}
    ${item_content}=    Replace Variables    ${item content template}
    ${doc_entity_id}=    Add DOCUMENT With String Data    ${experiment_id}    ${item_content}    application/x-url    ENTITY_LINK    Entity link
    ...    .url
    Commit Versioned Entity    ${link_experiment_id}
    Unlock entity    ${link_experiment_id}
    [Return]    ${doc_entity_id}

Add Entity Link Item With Preview To Experiment
    [Arguments]    ${experiment_id}    ${data_file}    ${preview_file}
    [Documentation]    Adds an entity link item to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${data_file} the data for the item
    ...
    ...    ${preview_file} the preview for the item ...
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    ${doc_entity_id}=    Add DOCUMENT (and Preview) To Experiment    ${experiment_id}    ${data_file}    ${preview_file}    application/x-url    ENTITY_LINK
    [Return]    ${doc_entity_id}

Add DOCUMENT To Experiment
    [Arguments]    ${experiment_id}    ${data_file_location}    ${mime type}    ${file type}    ${item_type}
    [Documentation]    Adds an item of specified type to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${data_file_location} \ where the data file is picked up
    ...
    ...    ${mime type} mime ype to match the file
    ...
    ...    ${file type} EWB file type to match the file, e.g. PNG_IMAGE, JPG_IMAGE
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${experiment_id}
    ${doc_entity_id}=    Add DOCUMENT With File Data    ${experiment_id}    ${data_file_location}    ${mime type}    ${file type}    ${item_type}
    Commit Versioned Entity    ${experiment_id}
    Unlock entity    ${experiment_id}
    [Return]    ${doc_entity_id}

Add DOCUMENT (and Preview) To Experiment
    [Arguments]    ${experiment_id}    ${data_file_location}    ${preview_file_location}    ${mime type}    ${file type}    ${item_type}=Uploaded Document
    [Documentation]    Adds an item of specified type with preview) to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${data_file_location} where the data file is picked up
    ...
    ...    ${preview_file_location} where the preview file is picked up
    ...
    ...    ${mime type} mime type to match the file
    ...
    ...    ${file type} EWB file type to match the file, e.g. PNG_IMAGE, JPG_IMAGE
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${experiment_id}
    ${doc_entity_id}=    Add DOCUMENT (and Preview) With File Data    ${experiment_id}    ${data_file_location}    ${preview_file_location}    ${mime type}    ${file type}
    ...    ${item_type}
    Commit Versioned Entity    ${experiment_id}
    Unlock entity    ${experiment_id}
    [Return]    ${doc_entity_id}

Add DOCUMENT (String) To Experiment
    [Arguments]    ${experiment_id}    ${string_data}    ${mime type}    ${data_type}    ${item_type}    ${file_type}
    [Documentation]    Adds an item of specified type to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${string_data} \ where the data file is picked up
    ...
    ...    ${mime type} mime type to match the file
    ...
    ...    ${data_type} EWB file type to match the file, e.g. PNG_IMAGE, JPG_IMAGE
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    ${file_type} - Describes the format of the data e.g. xml
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${experiment_id}
    ${doc_entity_id}=    Add DOCUMENT With String Data    ${experiment_id}    ${string_data}    ${mime type}    ${data_type}    ${item_type}
    ...    ${file_type}
    Commit Versioned Entity    ${experiment_id}
    Unlock entity    ${experiment_id}
    [Return]    ${doc_entity_id}

Add TEXT_DOCUMENT To Experiment
    [Arguments]    ${experiment_id}    ${data_file_location}    ${mime type}    ${file type}    ${item_type}
    [Documentation]    Adds an item of specified type to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${data_file_location} \ where the data file is picked up
    ...
    ...    ${mime type} mime type to match the file
    ...
    ...    ${file type} EWB file type to match the file, e.g. PNG_IMAGE, JPG_IMAGE
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${experiment_id}
    ${doc_entity_id}=    Add TEXT_DOCUMENT With File Data    ${experiment_id}    ${data_file_location}    ${mime type}    ${file type}    ${item_type}
    Commit Versioned Entity    ${experiment_id}
    Unlock entity    ${experiment_id}
    [Return]    ${doc_entity_id}

Add TEXT_COMPONENT To Text Item
    [Arguments]    ${experiment_id}    ${text_item_id}    ${data_file_location}    ${mime type}    ${file type}    ${item_type}
    [Documentation]    Adds an item of specified type to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${text_item_id} id of text item to put it in
    ...
    ...    ${data_file_location} \ where the data file is picked up
    ...
    ...    ${mime type} mime type to match the file
    ...
    ...    ${file type} EWB file type to match the file, e.g. PNG_IMAGE, JPG_IMAGE
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${experiment_id}
    ${doc_entity_id}=    Add TEXT_COMPONENT With File Data    ${text_item_id}    ${data_file_location}    ${mime type}    ${file type}    ${item_type}
    Commit Versioned Entity    ${experiment_id}
    Unlock entity    ${experiment_id}
    [Return]    ${doc_entity_id}

Add Page Break
    [Arguments]    ${experiment_id}
    [Documentation]    Adds an item of Page Break type to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${experiment_id}
    ${doc_entity_id}=    Add Page Break Entity    ${experiment_id}
    Commit Versioned Entity    ${experiment_id}
    Unlock entity    ${experiment_id}
    [Return]    ${doc_entity_id}

Add Link
    [Arguments]    ${experiment_id}    ${entity_name}    ${link_type}    ${data_text}
    [Documentation]    Adds an item of .url type to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${experiment_id}
    ${doc_entity_id}=    Add Link Entity    ${experiment_id}    ${entity_name}    ${link_type}    ${data_text}
    Commit Versioned Entity    ${experiment_id}
    Unlock entity    ${experiment_id}
    [Return]    ${doc_entity_id}

Add SPREADSHEET_DOCUMENT (and Preview) To Experiment
    [Arguments]    ${experiment_id}    ${data_file_location}    ${preview_file_location}    ${mime type}    ${file type}    ${item_type}=Uploaded Document
    [Documentation]    Adds an item of specified type with preview) to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${data_file_location} where the data file is picked up
    ...
    ...    ${preview_file_location} where the preview file is picked up
    ...
    ...    ${mime type} mime type to match the file
    ...
    ...    ${file type} EWB file type to match the file, e.g. PNG_IMAGE, JPG_IMAGE
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    Lock Entity    ${experiment_id}
    ${doc_entity_id}=    Add SPREADSHEET_DOCUMENT (and Preview) With File Data    ${experiment_id}    ${data_file_location}    ${preview_file_location}    ${mime type}    ${file type}
    ...    ${item_type}
    Commit Versioned Entity    ${experiment_id}
    Unlock entity    ${experiment_id}
    [Return]    ${doc_entity_id}

Add Plain Text Item To Experiment
    [Arguments]    ${experiment_id}    ${data_file_location}    ${item_type}=Uploaded text document
    [Documentation]    Adds a html text item to the experiment and version save
    ...
    ...
    ...    *Arguments*
    ...
    ...    ${experiment_id} id of exp or record to put it in
    ...
    ...    ${data_file_location} \ where the data file is picked up
    ...
    ...    ${item_type} - optional, set to item type property to be displayed (can be anything you like, it doesn't have to be to dow ith file type etc)
    ...
    ...    *Return value*
    ...    Entity id of the document created
    ...
    ...    *Precondition*
    ...    Experiment must exist
    ...
    ...    *Example*
    ${text_doc_entity_id}=    Add TEXT_DOCUMENT To Experiment    ${experiment_id}    ${data_file_location}    text/plain    PLAIN_TEXT    ${item_type}
    [Return]    ${text_doc_entity_id}
